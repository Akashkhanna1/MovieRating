<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Rating page</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css">
	<link rel="stylesheet" type="text/css" href="MovieRating.css">
</head>
<body>
	<div class="container mt-5">
		<div class="form-group">
			<select  id="movie-select" class="form-control custom-select">
				<option value="0" disabled selected> Select Movie </option>
				<option value="BlackPanther">BlackPanther</option>
				<option value="Avtar">Avtar</option>
				<option value="Inception">Inception</option>
				<option value="Parasite">Parasite</option>
				<option value="Joker">Joker</option>
				<option value="Godfather">Godfather</option>
				<option value="Vertigo">Vertigo</option>
				<option value="Titanic">Titanic</option>
				<option value="Avengers">The Avengers</option>
				<option value="LionKing">The Lion King</option>

			</select>
		</div>
		<div class="form-group">
			<input type="number" id="rating-control" class="form-control" step="0.1" max="5" placeholder="rate 1-5" disabled>
		</div>
		<table class="table table-striped">
			<thead>
				<tr>
					<th>Movies</th>
					<th>Rating</th>
				</tr>
			</thead>
			<tbody>
				<tr class="BlackPanther">
					<td>BlackPanther</td>
					<td>
						<div class="stars-outer">
							<div class="stars-inner"></div>
						</div>
						<span class="number-rating"></span>
					</td>
				</tr>
				<tr class="Avtar">
					<td>Avtar</td>
					<td>
						<div class="stars-outer">
							<div class="stars-inner"></div>
						</div>
						<span class="number-rating"></span>
					</td>
				</tr><tr class="Inception">
					<td>Inception</td>
					<td>
						<div class="stars-outer">
							<div class="stars-inner"></div>
						</div>
						<span class="number-rating"></span>
					</td>
				</tr>
				<tr class="Parasite">
					<td>Parasite</td>
					<td>
						<div class="stars-outer">
							<div class="stars-inner"></div>
						</div>
						<span class="number-rating"></span>
					</td>
				</tr>
				<tr class="Joker">
					<td>Joker</td>
					<td>
						<div class="stars-outer">
							<div class="stars-inner"></div>
						</div>
						<span class="number-rating"></span>
					</td>
				</tr>
				<tr class="Godfather">
					<td>Godfather</td>
					<td>
						<div class="stars-outer">
							<div class="stars-inner"></div>
						</div>
						<span class="number-rating"></span>
					</td>
				</tr>
				<tr class="Vertigo">
					<td>Vertigo</td>
					<td>
						<div class="stars-outer">
							<div class="stars-inner"></div>
						</div>
						<span class="number-rating"></span>
					</td>
				</tr>
				<tr class="Titanic">
					<td>Titanic</td>
					<td>
						<div class="stars-outer">
							<div class="stars-inner"></div>
						</div>
						<span class="number-rating"></span>
					</td>
				</tr>
				<tr class="Avengers">
					<td>The Avengers</td>
					<td>
						<div class="stars-outer">
							<div class="stars-inner"></div>
						</div>
						<span class="number-rating"></span>
					</td>
				</tr>
				<tr class="LionKing">
					<td>The Lion King</td>
					<td>
						<div class="stars-outer">
							<div class="stars-inner"></div>
						</div>
						<span class="number-rating"></span>
					</td>
				</tr>
			</tbody>
			
		</table>
		
	</div>
	<script>
		//initial ratings 
		const ratings ={
			BlackPanther: 4.7,
			Avtar: 3.4,
			Inception: 3.2,
			Parasite: 4.1,
			Joker: 4.5,
			Godfather: 3.1,
			Vertigo: 4.8,
			Titanic: 4.9,
			Avengers: 5,
			LionKing: 4.6
		}
		//Total Stars
		const starstotal=5;

		document.addEventListener('DOMContentLoaded',getratings);

		//from elements
		const movieselect = document.getElementById('movie-select');
		const ratingcontrol = document.getElementById('rating-control');

		// init movie
		let movie;

		movieselect.addEventListener('change',(e)=>{
			movie=e.target.value;
			//enabling rating control
			ratingcontrol.disabled = false;
			ratingcontrol.value = ratings[movie];
			});

		//Rating control change

		ratingcontrol.addEventListener('blur',(e)=>{
			const rating = e.target.value;

			if(rating>5){
				alert('please rate 1-5');
				return;
			}
			// changing the actual ratings

			ratings[movie]=rating;
			getratings();

		})

		function getratings(){
			for(let rating in ratings){
				//get percentage
				const startpercentage =(ratings[rating]/starstotal)*100;

				const startpercentagerounded=`${Math.round(startpercentage/10)*10}%`;

				//set width of stars-inner to percentage

				document.querySelector(`.${rating} .stars-inner`).style.width = startpercentagerounded;


				document.querySelector(`.${rating} .number-rating`).innerHTML = ratings[rating];

			}
		}
		
	</script>

</body>
</html>